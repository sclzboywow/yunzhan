# åˆ›å»ºæ–°ç‰ˆæœ¬èŒƒä¾‹

## ğŸ“¦ åœºæ™¯ï¼šå‘å¸ƒæ–°ç‰ˆæœ¬ v1.2.0

å‡è®¾æ‚¨æœ‰ä¸€ä¸ªæ–°çš„å®‰è£…åŒ… `myapp-v1.2.0.zip`ï¼Œéœ€è¦å‘å¸ƒç»™ç”¨æˆ·ã€‚

### 1. å‡†å¤‡æ–‡ä»¶ä¿¡æ¯

```bash
# æŸ¥çœ‹æ–‡ä»¶å¤§å°
ls -l myapp-v1.2.0.zip
# è¾“å‡ºï¼š-rw-r--r-- 1 user user 52428800 Jan 15 14:30 myapp-v1.2.0.zip

# è®¡ç®—æ–‡ä»¶å“ˆå¸Œå€¼
sha256sum myapp-v1.2.0.zip
# è¾“å‡ºï¼ša1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456  myapp-v1.2.0.zip
```

### 2. ä¸Šä¼ å®‰è£…åŒ…åˆ°æœåŠ¡å™¨

```bash
# ä¸Šä¼ åˆ°æ‚¨çš„æœåŠ¡å™¨
scp myapp-v1.2.0.zip user@yourdomain.com:/var/www/downloads/

# ç¡®ä¿å¯ä»¥é€šè¿‡HTTPè®¿é—®
# ä¾‹å¦‚ï¼šhttps://yourdomain.com/downloads/myapp-v1.2.0.zip
```

### 3. åˆ›å»ºæ–°ç‰ˆæœ¬è®°å½•

```bash
curl -X POST "http://localhost:8000/update/versions" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -d '{
    "version": "1.2.0",
    "version_code": 10200,
    "platform": "web",
    "release_notes": "ç‰ˆæœ¬ 1.2.0 æ›´æ–°å†…å®¹ï¼š

æ–°åŠŸèƒ½ï¼š
- æ·»åŠ äº†æ–‡ä»¶æœç´¢åŠŸèƒ½
- æ–°å¢æ‰¹é‡ä¸‹è½½åŠŸèƒ½
- ä¼˜åŒ–äº†ç”¨æˆ·ç•Œé¢

ä¿®å¤ï¼š
- ä¿®å¤äº†ç™»å½•çŠ¶æ€ä¸¢å¤±çš„é—®é¢˜
- ä¿®å¤äº†æ–‡ä»¶ä¸Šä¼ å¤±è´¥çš„é—®é¢˜
- ä¿®å¤äº†å†…å­˜æ³„æ¼é—®é¢˜

æ€§èƒ½ä¼˜åŒ–ï¼š
- æå‡äº†æ–‡ä»¶åŠ è½½é€Ÿåº¦
- å‡å°‘äº†å†…å­˜å ç”¨
- ä¼˜åŒ–äº†ç½‘ç»œè¯·æ±‚",
    "download_url": "https://yourdomain.com/downloads/myapp-v1.2.0.zip",
    "file_size": 52428800,
    "file_hash": "sha256:a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",
    "is_force_update": false,
    "is_latest": true
  }'
```

### 4. æˆåŠŸå“åº”ç¤ºä¾‹

```json
{
  "version": "1.2.0",
  "version_code": 10200,
  "platform": "web",
  "release_notes": "ç‰ˆæœ¬ 1.2.0 æ›´æ–°å†…å®¹ï¼š\n\næ–°åŠŸèƒ½ï¼š\n- æ·»åŠ äº†æ–‡ä»¶æœç´¢åŠŸèƒ½\n- æ–°å¢æ‰¹é‡ä¸‹è½½åŠŸèƒ½\n- ä¼˜åŒ–äº†ç”¨æˆ·ç•Œé¢\n\nä¿®å¤ï¼š\n- ä¿®å¤äº†ç™»å½•çŠ¶æ€ä¸¢å¤±çš„é—®é¢˜\n- ä¿®å¤äº†æ–‡ä»¶ä¸Šä¼ å¤±è´¥çš„é—®é¢˜\n- ä¿®å¤äº†å†…å­˜æ³„æ¼é—®é¢˜\n\næ€§èƒ½ä¼˜åŒ–ï¼š\n- æå‡äº†æ–‡ä»¶åŠ è½½é€Ÿåº¦\n- å‡å°‘äº†å†…å­˜å ç”¨\n- ä¼˜åŒ–äº†ç½‘ç»œè¯·æ±‚",
  "download_url": "https://yourdomain.com/downloads/myapp-v1.2.0.zip",
  "file_size": 52428800,
  "file_hash": "sha256:a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",
  "is_force_update": false,
  "is_latest": true,
  "created_at": "2025-01-15T14:30:00.000000"
}
```

### 5. éªŒè¯æ–°ç‰ˆæœ¬

```bash
# æ£€æŸ¥æ›´æ–°ï¼ˆä½¿ç”¨æ—§ç‰ˆæœ¬å·ï¼‰
curl "http://localhost:8000/update/check?client_version=1.1.0&client_platform=web"

# åº”è¯¥è¿”å›æœ‰æ›´æ–°
{
  "has_update": true,
  "current_version": "1.1.0",
  "latest_version": "1.2.0",
  "latest_version_info": {
    "version": "1.2.0",
    "version_code": 10200,
    "platform": "web",
    "release_notes": "ç‰ˆæœ¬ 1.2.0 æ›´æ–°å†…å®¹ï¼š...",
    "download_url": "https://yourdomain.com/downloads/myapp-v1.2.0.zip",
    "file_size": 52428800,
    "file_hash": "sha256:a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",
    "is_force_update": false,
    "is_latest": true,
    "created_at": "2025-01-15T14:30:00.000000"
  },
  "force_update": false,
  "message": "å‘ç°æ–°ç‰ˆæœ¬"
}
```

## ğŸ”§ å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `version` | ç‰ˆæœ¬å·ï¼ˆå”¯ä¸€ï¼‰ | "1.2.0" |
| `version_code` | ç‰ˆæœ¬ä»£ç ï¼ˆç”¨äºæ¯”è¾ƒï¼‰ | 10200 |
| `platform` | å¹³å°ç±»å‹ | "web", "desktop", "mobile" |
| `release_notes` | å‘å¸ƒè¯´æ˜ | è¯¦ç»†çš„æ›´æ–°å†…å®¹ |
| `download_url` | ä¸‹è½½é“¾æ¥ | å®Œæ•´çš„HTTP/HTTPSé“¾æ¥ |
| `file_size` | æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ | 52428800 |
| `file_hash` | æ–‡ä»¶å“ˆå¸Œå€¼ | "sha256:..." |
| `is_force_update` | æ˜¯å¦å¼ºåˆ¶æ›´æ–° | true/false |
| `is_latest` | æ˜¯å¦ä¸ºæœ€æ–°ç‰ˆæœ¬ | true/false |

## ğŸ“ ç‰ˆæœ¬ä»£ç è®¡ç®—

ç‰ˆæœ¬å· `x.y.z` è½¬æ¢ä¸ºç‰ˆæœ¬ä»£ç ï¼š
- `1.2.0` â†’ `10200` (1Ã—10000 + 2Ã—100 + 0)
- `1.2.1` â†’ `10201` (1Ã—10000 + 2Ã—100 + 1)
- `2.0.0` â†’ `20000` (2Ã—10000 + 0Ã—100 + 0)

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç‰ˆæœ¬å·å”¯ä¸€æ€§**ï¼šæ¯ä¸ªç‰ˆæœ¬å·åªèƒ½å­˜åœ¨ä¸€æ¬¡
2. **æœ€æ–°ç‰ˆæœ¬æ ‡è®°**ï¼šè®¾ç½® `is_latest=true` ä¼šè‡ªåŠ¨å°†åŒå¹³å°å…¶ä»–ç‰ˆæœ¬è®¾ä¸º `false`
3. **å¼ºåˆ¶æ›´æ–°**ï¼šè°¨æ…ä½¿ç”¨ `is_force_update=true`ï¼Œä¼šå¼ºåˆ¶ç”¨æˆ·æ›´æ–°
4. **ä¸‹è½½é“¾æ¥**ï¼šç¡®ä¿é“¾æ¥æœ‰æ•ˆä¸”å¯è®¿é—®
5. **æ–‡ä»¶å“ˆå¸Œ**ï¼šç”¨äºéªŒè¯æ–‡ä»¶å®Œæ•´æ€§
